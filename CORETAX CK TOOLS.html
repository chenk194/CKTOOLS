<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Halaman Terkunci</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(to bottom, #c62828, #fdd835, #6a1b9a);
      color: #fff;
      text-align: center;
      padding: 2rem;
    }

    #lockScreen, #mainContent {
      background: rgba(0, 0, 0, 0.2);
      border-radius: 15px;
      padding: 2rem;
      max-width: 650px;
      margin: auto;
      box-shadow: 0 0 10px rgba(0,0,0,0.3);
    }

    img {
      width: 100px;
      border-radius: 50%;
      margin-bottom: 1rem;
    }

    h1, h2 {
      margin-bottom: 1rem;
    }

    input[type="password"] {
      padding: 10px;
      font-size: 16px;
      border-radius: 5px;
      border: none;
      margin-top: 10px;
      width: 70%;
    }

    button {
      padding: 10px 20px;
      margin-top: 10px;
      font-size: 16px;
      border: none;
      border-radius: 5px;
      background-color: #fff;
      color: #000;
      font-weight: bold;
      cursor: pointer;
    }

    #lockScreen.fadeOut {
      opacity: 0;
      pointer-events: none;
      transition: opacity 1s ease;
    }

    a.link-button {
      display: inline-block;
      background: #fff;
      color: #000;
      padding: 0.8rem 1.2rem;
      font-weight: bold;
      border-radius: 8px;
      text-decoration: none;
      margin-top: 12px;
    }

    small {
      display: block;
      margin-top: 1rem;
      font-size: 0.9rem;
      color: #eee;
    }

    #wrong {
      color: yellow;
      margin-top: 10px;
      font-weight: bold;
    }
  </style>
</head>
<body>

<!-- Lock screen -->
<div id="lockScreen">
  <img
    src="../SERTIFIKAT ELEKTRONIK/logo.JPG"
    alt="Logo CK"
    onerror="this.onerror=null; this.src='https://i.imgur.com/c7Lbl6N.jpeg';"
  >
  <h2>üîí Halaman Terkunci</h2>
  <p>Masukkan password untuk membuka halaman ini.</p>
<input type="password" id="passwordInput" placeholder="Password" onkeydown="handleEnter(event)">
<br>
<button onclick="checkPassword()">Buka</button>
<p id="wrong" style="display:none;">‚ùå Password salah!</p>
</div>
<!-- Tambahkan ini dalam <script> -->
<script>
  function checkPassword() {
    const input = document.getElementById("passwordInput").value;
    const correct = "rahasia"; // Ganti dengan password Anda

    if (input === correct) {
      const lock = document.getElementById("lockScreen");
      lock.classList.add("fadeOut");
      setTimeout(() => {
        lock.style.display = "none";
        document.getElementById("mainContent").style.display = "block";
      }, 1000);
    } else {
      document.getElementById("wrong").style.display = "block";
    }
  }

  function handleEnter(event) {
    if (event.key === "Enter") {
      checkPassword();
    }
  }
</script>


<!-- Konten utama -->
<div id="mainContent" style="display:none;">
  <img
    src="../SERTIFIKAT ELEKTRONIK/logo.JPG"
    alt="Logo CK"
    onerror="this.onerror=null; this.src='https://i.imgur.com/c7Lbl6N.jpeg';"
  >
  <div class="section">
  <p><strong>ü§ñ KREDITKAN OTOMATIS + 3:</strong><br></p>
  <p>Pastikan Coretax Pajak Masukan terFilter Approved.</p>
  <button id="link-button">‚ñ∂Ô∏è Jalankan Otomatisasi</button>
  <script>
    document.getElementById("link-button").onclick = () => {
      const script = `(function () {
        const sleep = (ms) => new Promise(resolve => setTimeout(resolve, ms));
        let isRunning = false;
        const BULAN = ["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"];
        function getBulanIndex(namaBulan) {
          return BULAN.findIndex(b => b.toLowerCase() === namaBulan.toLowerCase());
        }
        async function kembaliKeGridDanRefresh() {
          console.log("‚Ü©Ô∏è Kembali ke grid & refresh");
          const kembaliBtn = [...document.querySelectorAll('a, button')].find(el =>
            el.textContent?.trim().toLowerCase().includes('pajak masukan'));
          kembaliBtn?.click();
          await sleep(2500);
          const refreshBtn = [...document.querySelectorAll('button')].find(btn =>
            btn.querySelector('.pi-refresh'));
          refreshBtn?.click();
          await sleep(3000);
        }
        async function pilihDropdownPengkreditan(bulanTarget) {
          const dropdown = document.querySelector('p-dropdown[placeholder*="Pengkreditan"]');
          dropdown?.querySelector('.p-dropdown-trigger')?.click();
          await sleep(1500);
          const panel = document.querySelector('.p-dropdown-items-wrapper');
          if (!panel) throw new Error("Dropdown panel tidak muncul");
          for (let i = 0; i < 6; i++) {
            panel.scrollBy(0, 100);
            await sleep(300);
          }
          const opsi = [...panel.querySelectorAll('li[role="option"]')].find(li =>
            li.getAttribute('aria-label')?.toLowerCase() === bulanTarget.toLowerCase());
          if (!opsi) throw new Error(\`Bulan "\${bulanTarget}" tidak ditemukan\`);
          opsi.click();
          console.log(\`‚úÖ Bulan \${bulanTarget} dipilih\`);
          await sleep(1800);
        }
        async function runAutomation() {
          if (isRunning) return;
          isRunning = true;
          while (true) {
            const tombolPensil = [...document.querySelectorAll('button#EditButton')];
            const belumDiproses = tombolPensil.find(btn => !btn.dataset.processed);
            if (!belumDiproses) {
              await sleep(3000);
              continue;
            }
            try {
              belumDiproses.dataset.processed = "true";
              belumDiproses.click();
              console.log("‚úèÔ∏è Membuka faktur...");
              await sleep(2500);
              let dropdownPengkreditan = null;
              for (let i = 0; i < 40; i++) {
                await sleep(300);
                dropdownPengkreditan = document.querySelector('p-dropdown[placeholder*="Pengkreditan"]');
                if (dropdownPengkreditan) break;
              }
              if (!dropdownPengkreditan) throw new Error("Dropdown Masa Pajak Pengkreditan tidak ditemukan");
              const masaSpan = document.querySelector('p-dropdown#Period span[title]');
              const bulanMasa = masaSpan?.getAttribute('title')?.trim();
              if (!bulanMasa) throw new Error("Gagal membaca Masa Pajak");
              const bulanIndex = getBulanIndex(bulanMasa);
              const bulanTarget = BULAN[(bulanIndex + 3) % 12];
              console.log(\`üìÜ Masa Pajak: \${bulanMasa} ‚Üí Target: \${bulanTarget}\`);
              await pilihDropdownPengkreditan(bulanTarget);
              const selectedSpan = document.querySelector('p-dropdown[placeholder*="Pengkreditan"] span[title]');
              const selectedBulan = selectedSpan?.getAttribute('title')?.trim();
              if (selectedBulan?.toLowerCase() !== bulanTarget.toLowerCase()) {
                throw new Error(\`Dropdown belum berubah ke "\${bulanTarget}", masih "\${selectedBulan}"\`);
              }
              const tombolKredit = [...document.querySelectorAll('button')].find(btn =>
                btn.textContent?.toLowerCase().includes('kredit'));
              if (!tombolKredit) throw new Error("Tombol Kredit tidak ditemukan");
              tombolKredit.click();
              console.log('üí∞ Klik tombol Kredit');
              await sleep(2500);
              for (let i = 0; i < 25; i++) {
                await sleep(300);
                if ([...document.querySelectorAll('*')].some(el =>
                  el.textContent?.includes('berhasil diperbarui'))) break;
              }
              await kembaliKeGridDanRefresh();
            } catch (err) {
              console.warn(\`‚ö†Ô∏è Error: \${err.message}\`);
              await kembaliKeGridDanRefresh();
            }
          }
          isRunning = false;
        }
        const tombolLama = document.getElementById("btnMulaiAuto");
        if (tombolLama) tombolLama.remove();
        const tombol = document.createElement("button");
        tombol.id = "btnMulaiAuto";
        tombol.innerText = "‚ñ∂Ô∏è Mulai Otomatisasi";
        tombol.style = "position: fixed; bottom: 20px; right: 20px; z-index: 9999; padding: 10px 15px; font-size: 14px; background: #1f883d; color: white; border: none; border-radius: 6px; cursor: pointer;";
        tombol.onclick = runAutomation;
        document.body.appendChild(tombol);
      })();`;

      navigator.clipboard.writeText(`javascript:${script}`).then(() => {
        alert("‚úÖ Script disalin ke clipboard!\nüîñ Sekarang tempel di bookmark browser (buat bookmark baru, paste ke bagian URL).");
      });
    };
  </script>
  </div>

  <div class="section">
    <p><strong>üì• CK Downloader Detail:</strong><br>Unduh data dari berbagai endpoint DJP (API)</p>
    <a class="link-button" href='javascript:(function(){let apis=["/einvoiceportal/api/outputinvoice/list","/einvoiceportal/api/inputinvoice/list","/einvoiceportal/api/outputreturn/list","/einvoiceportal/api/inputreturn/list","/einvoiceportal/api/specialdocumentoutputinvoice/list","/einvoiceportal/api/specialdocumentinputinvoice/list","/einvoiceportal/api/specialdocumentoutputreturn/list","/einvoiceportal/api/specialdocumentinputreturn/list","/withholdingslipsportal/api/getebupotbpuissued","/withholdingslipsportal/api/getebupotbp21issued","/withholdingslipsportal/api/getebupotbpa1issued","/withholdingslipsportal/api/getebupotmpissued","/accountingportal/api/taxpayeraccounting/list"];let menu=`Pilih API endpoint (1-${apis.length}):\n`+apis.map((x,i)=>`${i+1}. ${x}`).join("\n");let i=prompt(menu);if(!i)return;let n=parseInt(i);if(isNaN(n)||n<1||n>apis.length){alert("Pilihan tidak valid.");return;}let r=prompt("Masukkan jumlah Rows:","10000");if(!r)return;let u=apis[n-1];function d(c,f){let b=new Blob([c],{type:"text/plain"}),a=document.createElement("a");a.href=URL.createObjectURL(b);a.download=f;document.body.appendChild(a);a.click();document.body.removeChild(a);}let o=XMLHttpRequest.prototype.open,s=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.open=function(m,u2){this._isTarget=u2.includes(u);return o.apply(this,arguments);};XMLHttpRequest.prototype.send=function(b){if(this._isTarget&&b){try{let j=JSON.parse(b);j.Rows=r;b=JSON.stringify(j);}catch(e){}}this.addEventListener("load",function(){if(this._isTarget&&this.responseText){let name=u.split("/api/")[1].split("/")[0];d(this.responseText,name+".txt");}});return s.apply(this,[b]);};let f=window.fetch;window.fetch=async(u2,o)=>{if(u2.includes(u)&&o&&o.body){try{let b=JSON.parse(o.body);b.Rows=r;o.body=JSON.stringify(b);}catch(e){}}let res=await f(u2,o);if(u2.includes(u)){res.clone().text().then(t=>{let name=u.split("/api/")[1].split("/")[0];d(t,name+".txt");});}return res;};alert("‚úÖ Klik tombol Refresh halaman di DJP, lalu muat ulang data.");})();'>DOWNLOADER DETAIL</a>
  </div>

<div class="section">
  <p><strong>üì• GABUNG SCRIPT:</strong><br>Gabungkan file .txt menjadi Excel</p>
  <a id="downloadLink3" class="link-button">üìÑ Unduh Gabung Script</a>
</div>

<script>
  const link3 = document.getElementById("downloadLink3");
  if (location.protocol === "file:") {
    link3.href = "../CK/GABUNG TXT RINCIAN CORETAX.rar";
    link3.download = "GABUNG TXT RINCIAN CORETAX.rar";
  } else {
    link3.href = "https://drive.google.com/uc?export=download&id=14cC2BxkoxzDPtGCnwrZiNv0KJVeRXctJ";
  }
</script>

<div class="section">
  <p><strong>üì• RENAME SCRIPT:</strong><br>Rename PDF faktur, bukti potong, retur, dll</p>
  <a id="downloadLink4" class="link-button">üìÑ Unduh Rename PDF</a>
</div>

<script>
  const link4 = document.getElementById("downloadLink4");
  if (location.protocol === "file:") {
    link4.href = "../CK/RENAME FAKTUR DAN BUKTI POTONGck V2.1.rar";
    link4.download = "RENAME FAKTUR DAN BUKTI POTONGck V2.1.rar";
  } else {
    link4.href = "https://drive.google.com/uc?export=download&id=1o-o2uNcpUL2zC_vVSGxAOx8-mncF49xA";
  }
</script>

<div class="section">
  <p><strong>üì• REKAP PDF SPT PPN:</strong><br>File PDF SPT PPN Coretax</p>
  <a id="downloadLink5" class="link-button">üìÑ Unduh REKAP SPT PPN</a>
</div>

<script>
  const link5 = document.getElementById("downloadLink5");
  if (location.protocol === "file:") {
    link5.href = "../CK/REKAP SPT PPN.rar";
    link5.download = "REKAP SPT PPN.rar";
  } else {
    link5.href = "https://drive.google.com/uc?export=download&id=1arZGsAg_LYtrIOSKzbZu7wu-r5H1RBXr";
  }
</script>



<br><small>¬© 2025 CK Tools | Untuk keperluan pribadi</small>
  </div>





<script>
  function checkPassword() {
    const input = document.getElementById("passwordInput").value;
    const correct = "1"; // ‚Üê Ganti password sesuai keinginan

    if (input === correct) {
      const lock = document.getElementById("lockScreen");
      lock.classList.add("fadeOut");
      setTimeout(() => {
        lock.style.display = "none";
        document.getElementById("mainContent").style.display = "block";
      }, 1000);
    } else {
      document.getElementById("wrong").style.display = "block";
    }
  }
</script>

</body>
</html>
